<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org">
<head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script th:inline="javascript">
        //thymeleaf to javascript variables
        /*<![CDATA[*/
        var sortProperty = /*[[${sortProperty}]]*/ null;
        var sortDesc = /*[[${sortDesc}]]*/ null;
        var currentPage = /*[[${taskPage.number}]]*/ 0;
        var pageSize =/*[[${taskPage.size}]]*/ 0;
        /*]]>*/

        $(document).ready(function(){
            //show up/down arrows
            $("table#task-table thead th").each(function(){
                var head = $(this);
                if(head.attr('data-sort-prop')==sortProperty){
                    head.append(sortDesc?'▾':'▴');
                }
            });

            //set click action, reload page on clicking with all query params
            $("table#task-table thead th").click(function() {
                var headerSortPropName = $(this).attr("data-sort-prop");
                if(headerSortPropName==sortProperty){
                    window.location.href = window.location.pathname+
                        '?page='+currentPage+'&size='+pageSize+'&sort='+ headerSortPropName+','+
                        (sortDesc?'asc':'desc');
                }else{
                    window.location.href = window.location.pathname+
                        '?page='+currentPage+'&size='+pageSize+'&sort='+ headerSortPropName+',asc';
                }
            });
        });
    </script>
</head>
<body>
<h2>Tasks</h2>
<table id="task-table">
    <thead>
    <tr>
        <th data-sort-prop="id">Id</th>
        <th data-sort-prop="taskSubject">taskSubject</th>
        <th data-sort-prop="taskDetails">taskDetails</th>
<!--        <th data-sort-prop="salary">Salary</th>-->
    </tr>
    </thead>
    <tr th:each="task : ${taskPage.content}">
        <td th:text="${task.id}"></td>
        <td th:text="${task.taskSubject}"></td>
        <td th:text="${task.taskDetails}"></td>
<!--        <td th:text="${task.salary}"></td>-->
    </tr>
</table>
<!-- using th:with to declare a local variable for sorting query param -->
<div class="pagination-div" th:with="sortParam=${sortProperty+','+(sortDesc?'desc':'asc')}">
    <span th:if="${taskPage.hasPrevious()}">
        <a th:href="@{/employees(page=${taskPage.number-1},size=${taskPage.size},sort=${sortParam})}">Previous</a>
    </span>
    <th:block th:each="i: ${#numbers.sequence(0, taskPage.totalPages - 1)}">
        <span th:if="${taskPage.number == i}" class="selected">[[${i}+1]]</span>
        <span th:unless="${taskPage.number == i}">
             <a th:href="@{/employees(page=${i},size=${taskPage.size},sort=${sortParam})}">[[${i}+1]]</a>
        </span>
    </th:block>
    <span th:if="${taskPage.hasNext()}">
        <a th:href="@{/employees(page=${taskPage.number+1},size=${taskPage.size},sort=${sortParam})}">Next</a>
    </span>
</div>
</body>
</html>